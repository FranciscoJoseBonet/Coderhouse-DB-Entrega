<h1>Cart Details</h1>

{{#if cart}}
	{{#if cart.products.length}}
		<ul id="cartList">
			{{#each cart.products}}
				{{#if product}}
					<li data-product-id="{{product._id}}">
						<div class="title">{{product.title}}</div>
						<div class="meta">ID: {{product._id}} | Code: {{product.code}}</div>
						<div class="price">Price: ${{product.price}}</div>
						<div>Quantity: {{quantity}}</div>
						<div>Subtotal: ${{multiply product.price quantity}}</div>

						<div class="actions">
							<button
								style="color: #fff; background: #ff1212"
								onclick="deleteProduct('{{product._id}}')"
							> Delete Product </button>

						</div>
					</li>
				{{/if}}
			{{/each}}
		</ul>
		<h2 class="total">Total: ${{total}}</h2>
	{{else}}
		<p class="empty-cart">Carrito vac√≠o</p>
	{{/if}}

	<p>Status: <strong>{{cart.status}}</strong></p>
	<p>Created: {{cart.createdAt}}</p>
	<p>Updated: {{cart.updatedAt}}</p>

{{else}}
	<p>No cart found.</p>
{{/if}}

<p><a href="/api/carts" class="back-link">Go Back to Carts</a></p>

<link rel="stylesheet" href="/css/cart.css" />

<script>
	async function deleteProduct(productId) { const res = await fetch(`/api/carts/{{cart._id}}/products/${productId}`,
	{ method: "DELETE" }); const data = await res.json(); if (data.success) {
	alert("Producto eliminado correctamente"); location.reload(); } else {
	alert(data.message || "Error al eliminar el producto"); } }
</script>